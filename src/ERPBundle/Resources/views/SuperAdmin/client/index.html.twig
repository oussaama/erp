{% extends 'base.html.twig' %}
{% block title %}SuperAdmin - Client{% endblock %}
{% block stylesheets %}
    <script type="text/javascript">
        //<![CDATA[
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-92643213-2']);
        _gaq.push(['_trackPageview']);
        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
        (function (b) {
            (function (a) {
                "__CF" in b && "DJS" in b.__CF ? b.__CF.DJS.push(a) : "addEventListener" in b ? b.addEventListener("load", a, !1) : b.attachEvent("onload", a)
            })(function () {
                "FB" in b && "Event" in FB && "subscribe" in FB.Event && (FB.Event.subscribe("edge.create", function (a) {
                    _gaq.push(["_trackSocial", "facebook", "like", a])
                }), FB.Event.subscribe("edge.remove", function (a) {
                    _gaq.push(["_trackSocial", "facebook", "unlike", a])
                }), FB.Event.subscribe("message.send", function (a) {
                    _gaq.push(["_trackSocial", "facebook", "send", a])
                }));
                "twttr" in b && "events" in twttr && "bind" in twttr.events && twttr.events.bind("tweet", function (a) {
                    if (a) {
                        var b;
                        if (a.target && a.target.nodeName == "IFRAME")a:{
                            if (a = a.target.src) {
                                a = a.split("#")[0].match(/[^?=&]+=([^&]*)?/g);
                                b = 0;
                                for (var c; c = a[b]; ++b)if (c.indexOf("url") === 0) {
                                    b = unescape(c.split("=")[1]);
                                    break a
                                }
                            }
                            b = void 0
                        }
                        _gaq.push(["_trackSocial", "twitter", "tweet", b])
                    }
                })
            })
        })(window); //]]>
    </script>
    <script type="text/javascript">
        //<![CDATA[
        try {
            if (!window.CloudFlare) {
                var CloudFlare = [{
                    verbose: 0,
                    p: 0,
                    byc: 0,
                    owlid: "cf",
                    bag2: 1,
                    mirage2: 0,
                    oracle: 0,
                    paths: {cloudflare: "/cdn-cgi/nexp/dok3v=1613a3a185/"},
                    atok: "0058b165fc78163e6d148677944b9ad6",
                    petok: "8ddbcbc9feff803550a9f3ceca501f2cd0d28aa0-1496996202-1800",
                    zone: "themesadmin.com",
                    rocket: "0",
                    apps: {"ga_key": {"ua": "UA-92643213-2", "ga_bs": "2"}}
                }];
                !function (a, b) {
                    a = document.createElement("script"), b = document.getElementsByTagName("script")[0], a.async = !0, a.src = "../../../../../ajax.cloudflare.com/cdn-cgi/nexp/dok3v%3d85b614c0f6/cloudflare.min.js", b.parentNode.insertBefore(a, b)
                }()
            }
        } catch (e) {
        }
        ;
        //]]>
    </script>
    <link rel="stylesheet" href="{{ asset('assets/global/plugins/bootstrap/dist/css/bootstrap.min.css') }}"/>
    <link rel="stylesheet" href="{{ asset('assets/icons_fonts/elegant_font/elegant.min.css') }}"/>
    <link id="site-color" rel="stylesheet" href="{{ asset('assets/layouts/layout-left-menu/css/color/light/color-default.min.css') }}"/>
    <link rel="stylesheet" href="{{ asset('assets/global/plugins/switchery/dist/switchery.min.css') }}"/>
    <link rel="stylesheet" href="{{ asset('assets/global/plugins/perfect-scrollbar/css/perfect-scrollbar.min.css') }}"/>
    <link rel="stylesheet" href="{{ asset('assets/global/plugins/datatables/media/css/dataTables.bootstrap4.min.css') }}"/>
    <link rel="stylesheet" href="{{ asset('assets/global/plugins/datatables-responsive/css/responsive.bootstrap4.min.css') }}"/>
    <link rel="stylesheet" href="{{ asset('assets/global/plugins/datatables-scroller/css/scroller.bootstrap4.min.css') }}"/>
    <link rel="stylesheet" href="{{ asset('assets/global/css/components.min.css') }}"/>
    <link rel="stylesheet" href="{{ asset('assets/layouts/layout-left-menu/css/layout.min.css') }}"/>

{% endblock %}
{% block header %}
    {{ render(controller('ERPBundle:SuperAdmin/SuperAdmin:header')) }}
{% endblock %}
{% block body %}
    <div class="row">
        <section id="content-wrapper">
            {% block menu %}{% include '::headers/menuSuperAdmin.html.twig' %}{% endblock %}
            <div class="site-content-title">
                <h2 class="float-xs-left content-title-main">Client</h2>

                <ol class="breadcrumb float-xs-right">
                    <li class="breadcrumb-item">
                        <span class="fs1" aria-hidden="true" data-icon="î´"></span>
                        <a href="{{ path('super_admin_homepage') }}">Home</a>
                    </li>
                    <li class="breadcrumb-item"><a href="{{ path('super_admin_client') }}">Client</a></li>
                    <li class="breadcrumb-item active">index</li>
                </ol>

            </div>
            <div class="content content-datatable datatable-width">
                <div class="row">
                    <div class='col-md-offset-10'>
                            <button class="btn btn-primary site-btn" data-target="#view-add" data-toggle="modal">
                                Ajouter
                            </button>
                    </div>
                    <div class="divider15"></div>
                    <div>
                        <div class="row">
                            <div class="col-md-12">
                                <table data-plugin="datatable" data-responsive="true" class="table table-striped table-hover dt-responsive">
                                    <thead>
                                    <tr>
                                        <th>Nom de Client</th>
                                        <th>CIN</th>
                                        <th>Email</th>
                                        <th>Date d'Ajouter</th>
                                        <th>Adresse</th>
                                        <th>Telephone</th>
                                        <th>Etablissement</th>
                                        <th>action</th>
                                        <th>Statu</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% for e in client %}
                                        {% if e.enabled == 1 %}
                                        <tr>
                                            <td>{{ e.fullName }}</td>
                                            <td>{{ e.cin }}</td>
                                            <td>{{ e.dateAjout|date('M d Y H:i') }}</td>
                                            <td>{{ e.mail }}</td>
                                            <td>{{ e.adresse }} , {{ e.ville }} {{ e.cp }} , {{ e.pays }}</td>
                                            <td>{{ e.tel }}</td>
                                            <td>
                                                <a href="{{ path('super_admin_etablissement',{'id':e.id}) }}"><button type="button" class="btn btn-outline-secondary btn-xs">Info</button></a>
                                                <a><button type="button" class="btn btn-outline-info btn-xs add-Etablissement" data-target="#view-add-etablissement" data-toggle="modal" data-id="{{ e.id }}">Ajouter</button> </a>
                                            </td>
                                            <td>
                                                <a><button type="button" class="btn btn-outline-primary btn-xs update-Client" data-target="#view-update-client" data-toggle="modal" data-id="{{ e.id }}">Update</button></a>
                                            </td>
                                            <td>
                                                <a><button type="button" class="btn btn-xs btn-outline-success btn-xs desactivt" data-id="{{ e.id }}" data-target="#view-contact" data-toggle="modal">Active</button></a>
                                            </td>
                                        </tr>
                                        {% else %}
                                            <tr>
                                                <td>{{ e.fullname }}</td>
                                                <td>{{ e.cin }}</td>
                                                <td>{{ e.dateAjout|date('M d Y H:i') }}</td>
                                                <td>{{ e.mail }}</td>
                                                <td>{{ e.adresse }} , {{ e.ville }} {{ e.cp }} , {{ e.pays }}</td>
                                                <td>{{ e.tel }}</td>
                                                <td>
                                                    <a href="{{ path('super_admin_etablissement',{'id':e.id}) }}"><button type="button" class="btn btn-outline-info btn-xs" disabled>Info</button></a>
                                                    <a><button type="button" class="btn btn-outline-info btn-xs" disabled>Ajouter</button> </a>
                                                </td>
                                                <td>
                                                    <a><button type="button" class="btn btn-outline-primary btn-xs" disabled>Update</button></a>
                                                </td>
                                                <td>
                                                    <a><button type="button" class="btn btn-xs btn-outline-danger desactivt" data-id="{{ e.id }}" data-target="#view-contact" data-toggle="modal">Desactive</button></a>
                                                </td>
                                            </tr>
                                        {% endif %}
                                    {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
        </section>

         <div id="view-contact" class="modal fade">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close contact-close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                    <h4 class="modal-title">Activation de Client</h4>
                                </div>
                                <div class="modal-body contact-info">
                                    <div class="row">
                                        <div class="col-xs-12">
                                            <div class="divider15"></div>
                                            <div class="contact-follow">
                                                <div class="profile-icon text-xs-center">
                                                    <p>sddssdsdsdssd</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button"  class="btn btn-primary edit-profile edit save-btn desactiv">Confirmer</button>
                                    <button type="button" class="btn btn-secondary close-btn" data-dismiss="modal">Close
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>




        <div id="view-add" class="modal fade">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close contact-close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        <h4 class="modal-title">Ajouter Client</h4>
                    </div>
                    <div class="modal-body contact-info">
                        <div class="row">
                            <div class="col-xs-12">
                                <div class="divider15"></div>
                                <div class="contact-follow">
                                    {{ render(controller('ERPBundle:SuperAdmin/SuperAdmin:addClient')) }}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="view-update-client" class="modal fade">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close contact-close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        <h4 class="modal-title">Update Client</h4>
                    </div>
                    <div class="modal-body contact-info">
                        <div class="row">
                            <div class="col-xs-12">
                                <div class="divider15"></div>
                                <div class="contact-follow">
                                    <script type="text/javascript">
                                        $('.update-Client').click(function(){
                                            id = $(this).data('id');
                                            $.ajax({
                                                type: 'POST',
                                                url: Routing.generate('super_admin_client_update',{'id':id}),
                                                complete: function(data) {
                                                    $('.contact-follow').html(data.responseText)
                                                }
                                            });
                                        });
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="view-add-etablissement" class="modal fade">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close contact-close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        <h4 class="modal-title">Ajouter Etablissement</h4>
                    </div>
                    <div class="modal-body contact-info">
                        <div class="row">
                            <div class="col-xs-12">
                                <div class="divider15"></div>
                                <div class="contact-follow">
                                    <script type="text/javascript">
                                        $('.add-Etablissement').click(function(){
                                            id = $(this).data('id');
                                            $.ajax({
                                                type: 'POST',
                                                url: Routing.generate('super_admin_etablissement_create',{'id':id}),
                                                complete: function(data) {
                                                    $('.contact-follow').html(data.responseText)
                                                }
                                            });
                                        });
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
        {% block javascripts %}
            <script type="text/javascript"
                    src="{{ asset('assets/global/plugins/jquery/dist/jquery.min.js') }}"></script>
            <script type="text/javascript"
                    src="{{ asset('assets/global/plugins/tether/dist/js/tether.min.js') }}"></script>
            <script type="text/javascript"
                    src="{{ asset('assets/global/plugins/bootstrap/dist/js/bootstrap.min.js') }}"></script>
            <script type="text/javascript"
                    src="{{ asset('assets/global/plugins/perfect-scrollbar/js/perfect-scrollbar.jquery.min.js') }}"></script>
            <script type="text/javascript"
                    src="{{ asset('assets/global/plugins/switchery/dist/switchery.min.js') }}"></script>
            <script type="text/javascript"
                    src="{{ asset('assets/global/plugins/screenfull.js/dist/screenfull.min.js') }}"></script>
            <script type="text/javascript" src="{{ asset('assets/global/plugins/classie/classie.js') }}"></script>
            <script type="text/javascript"
                    src="{{ asset('assets/global/plugins/datatables/media/js/jquery.dataTables.min.js') }}"></script>
            <script type="text/javascript"
                    src="{{ asset('assets/global/plugins/datatables/media/js/dataTables.bootstrap4.min.js') }}"></script>
            <script type="text/javascript"
                    src="{{ asset('assets/global/plugins/datatables-responsive/js/dataTables.responsive.js') }}"></script>
            <script type="text/javascript"
                    src="{{ asset('assets/global/plugins/datatables-responsive/js/responsive.bootstrap4.js') }}"></script>
            <script type="text/javascript"
                    src="{{ asset('assets/global/plugins/datatables-scroller/js/dataTables.scroller.js') }}"></script>
            <script type="text/javascript"
                    src="{{ asset('assets/global/plugins/editable-table/mindmup-editabletable.js') }}"></script>
            <script type="text/javascript"
                    src="{{ asset('assets/global/plugins/editable-table/numeric-input-example.js') }}"></script>
            <script type="text/javascript" src="{{ asset('assets/global/js/site.min.js') }}"></script>
            <script type="text/javascript" src="{{ asset('assets/global/js/site-settings.min.js') }}"></script>
            <script type="text/javascript" src="{{ asset('assets/global/js/global/datatable.js') }}"></script>
            <script type="text/javascript" src="{{ asset('assets/layouts/layout-left-menu/js/layout.min.js') }}"></script>
            <script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.13.1/jquery.validate.js"></script>
            <script>
                $('.desactivt').click(function() {
                    id = $(this).data('id');
                    $('.desactiv').click(function () {
                       $.ajax({
                            url:  'http://localhost/erp/web/app_dev.php/backend/client/delete/'+id,
                            success: function (result) {
                                console.log(result);
                                window.location.href = "http://localhost/erp/web/app_dev.php/backend/client";
                            },
                           failed: function(a){
                                console.log(a);
                           }
                        });
                    });
                });
            </script>
        {% endblock %}